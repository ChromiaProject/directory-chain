definitions:
  common.init: &common_init
    initial_provider: ${INITIAL_PROVIDER:-03ECD350EEBC617CBBFBEF0A1B7AE553A748021FD65C7C50C5ABB4CA16D4EA5B05}
    genesis_node:
      - ${GENESIS_NODE:-0350fe40766bc0ce8d08b3f5b810e49a8352fdd458606bd5fafe5acdcdc8ff3f57}
      - ${GENESIS_HOST_NAME:-localhost}
      - 9870
      - ${GENESIS_API_URL:-http://localhost:7740}
      - ${GENESIS_TERRITORY}
  config: &common_config
    config_consensus_strategy: HEADER_HASH
    blockstrategy:
      maxblocktime: 2000
    revolt:
      fast_revolt_status_timeout: 2000
    signers:
      - x"0350fe40766bc0ce8d08b3f5b810e49a8352fdd458606bd5fafe5acdcdc8ff3f57"
    sync_ext:
      - "net.postchain.d1.icmf.IcmfReceiverSynchronizationInfrastructureExtension"
    gtx:
      modules:
        - "net.postchain.d1.icmf.IcmfSenderGTXModule"
        - "net.postchain.d1.icmf.IcmfReceiverGTXModule"
    icmf:
      receiver:
        anchoring:
          topics:
            - G_configuration_updated
            - G_configuration_failed
            - G_last_anchored_heights
  proposal_blockchain.util: &proposal_blockchain_util
    max_config_path_depth: 10
    max_config_size: 2097152 # 2 MiB

blockchains:
  manager:
    module: management_chain_directory1
    config: *common_config
    moduleArgs:
      common.init: *common_init
      common:
        allow_blockchain_dependencies: false
        provider_quota_max_actions_per_day: 100
      proposal_blockchain.util: *proposal_blockchain_util
  devnet:
    module: management_chain_testnet
    config: *common_config
    moduleArgs:
      common.init: *common_init
      common:
        allow_blockchain_dependencies: false
        provider_quota_max_actions_per_day: 100
      auth_service:
        pubkey: x"02B6F2967CF9AFC4D289EF475A2C2DDEC9EAB79AC60C1C99683E3134074619E635"
        include_system_cluster: true
      housekeeping:
        # 48h
        max_empty_container_time: 172800000
      proposal_blockchain.util: *proposal_blockchain_util
  mainnet:
    module: management_chain_mainnet
    config:
      << : *common_config
      gtx:
        modules:
          - "net.postchain.d1.icmf.IcmfSenderGTXModule"
          - "net.postchain.d1.icmf.IcmfReceiverGTXModule"
      icmf:
        receiver:
          anchoring:
            topics:
              - G_configuration_updated
              - G_configuration_failed
              - G_last_anchored_heights
          global:
            topics:
              - G_create_cluster
              - G_create_container
              - G_upgrade_container
              - G_stop_container
              - G_restart_container
    moduleArgs:
      common.init: *common_init
      common:
        allow_blockchain_dependencies: false
        provider_quota_max_actions_per_day: 100
      proposal_blockchain.util: *proposal_blockchain_util
  system_anchoring:
    module: anchoring_chain_system
    config:
      config_consensus_strategy: HEADER_HASH
      blockstrategy:
        maxblocktime: 300000
        name: "net.postchain.d1.anchoring.AnchoringBlockBuildingStrategy"
      revolt:
        fast_revolt_status_timeout: 2000
      sync_ext:
        - "net.postchain.d1.icmf.IcmfReceiverSynchronizationInfrastructureExtension"
      gtx:
        modules:
          - "net.postchain.d1.anchoring.system.SystemAnchoringGTXModule"
          - "net.postchain.d1.icmf.IcmfSenderGTXModule"
          - "net.postchain.d1.icmf.IcmfReceiverGTXModule"
      icmf:
        receiver:
          global:
            topics:
              - G_get_last_anchored_heights
  cluster_anchoring:
    module: anchoring_chain_cluster
    config:
      config_consensus_strategy: HEADER_HASH
      blockstrategy:
        maxblocktime: 300000
        name: "net.postchain.d1.anchoring.AnchoringBlockBuildingStrategy"
      revolt:
        fast_revolt_status_timeout: 2000
      sync_ext:
        - "net.postchain.d1.icmf.IcmfReceiverSynchronizationInfrastructureExtension"
      gtx:
        modules:
          - "net.postchain.d1.anchoring.cluster.ClusterAnchoringGTXModule"
          - "net.postchain.d1.icmf.IcmfSenderGTXModule"
          - "net.postchain.d1.icmf.IcmfReceiverGTXModule"
      icmf:
        receiver:
          global:
            topics:
              - G_get_last_anchored_heights
  economy_chain:
    module: economy_chain
    config:
      config_consensus_strategy: HEADER_HASH
      revolt:
        fast_revolt_status_timeout: 2000
      sync_ext:
        - "net.postchain.d1.icmf.IcmfReceiverSynchronizationInfrastructureExtension"
      gtx:
        modules:
          - "net.postchain.d1.icmf.IcmfReceiverGTXModule"
          - "net.postchain.d1.icmf.IcmfSenderGTXModule"
      icmf:
        receiver:
          anchoring:
            topics:
              - G_node_availability_report
          directory-chain:
            topics:
              - L_create_cluster_error
              - L_ticket_container_result
              - L_cluster_update
              - L_provider_update
              - L_node_update
              - L_cluster_node_update
              - L_token_price_changed
              - L_blockchain_rid_topic
          global:
            topics:
              - G_evm_transaction_submitter_cost_topic
      eif:
        snapshot:
          levels_per_page: 2
          snapshots_to_keep: 2
        chains:
          bsc_testnet:
            network_id: 97
            contracts:
              - "0x3491B312aB31701da81042ABF6A170BEEF85eF3e"
            skip_to_height: 38713553
            evm_read_offset: 3
            read_offset: 3
            events: !include config/events.yaml
    moduleArgs:
      lib.ft4.admin:
        admin_pubkey: 02a829e1d7fffbd856a04b53ec7d478d8896803b571c7700ec464d6a9d4f0e3bbd
      lib.ft4.accounts:
        rate_limit:
          active: 1
          max_points: 20
          recovery_time: 5000
          points_at_account_creation: 1
      lib.auth:
        # TODO set proper pubkey for auth-server-ft4
        auth_pubkey: x"0317FF1ECF25B04026B6F9FA1960BA58070FB1CFC98519F7BC02D71ED1B00B1997"
      economy_chain:
        evm_asset_network_id: 97
        evm_asset_address: "8A2279d4A90B6fe1C4B30fa660cC9f926797bAA2"
        evm_asset_name: "tCHR"
        evm_asset_symbol: "tCHR"
        evm_asset_decimals: 6
        asset_name: "Chromia Test"
        asset_symbol: "tCHR"
        asset_decimals: 6
        asset_icon: "https://s3.eu-central-1.amazonaws.com/www.chromiadev.net/assets/tCHR.png"
        amount_to_mint: 1000000000
        pool_amount_to_mint: 1000000000
        # TODO set proper pool account pubkey,
        # corresponding private key for this test key is FD8F9D4F1327DA6622B969DDD835CB41C982FAA805E614D7F4F4F0ADBCAD135F
        pool_account_pubkey: x"032FF500E33BC4DF87C7F40C167ADA6DBE52955066DD3F689189ED221B913BFD8F"
        # TODO set proper pool chromia foundation account pubkey,
        chromia_foundation_account_pubkey: x"132FF500E33BC4DF87C7F40C167ADA6DBE52955066DD3F689189ED221B913BFD8F"
        # TODO set proper pubkey for admin
        admin_pubkey: x"0317AC5B309A05B81A68F1A64321A3C6E6799E037C12892838682EBB9A620316A6"
        staking_initial_reward_rate: 0.15
        staking_rate_change_delay_ms: 604800000
        staking_withdrawal_delay_ms: 1209600000
        staking_delegation_delay_ms: 604800000
        staking_payout_interval_ms: 31536000000 # Good for testing
        test_chr_refill_limit_millis: 604800000 # 1 week
        test_chr_pool_refill_limit_millis: 86400000 # 1 day
        max_bridge_leases_per_container: 10
        evm_transaction_submitters_bonus: 0.1
        default_providers:
          Chromaway: x"02EC8AC937846DF24C939801BB0155EE0C1B7CBE4993ACD7669B8962BE1033A4A9"
          Sunube: x"03D4C71C2B63F6CE7F4C29D91F651FE9AA3E936CCAD8FA73633A4315CB2CDCACEB"
          Dwellir: x"02576A126D3FC8588F7756857198294B1C7064E6926D264353A996E44B6E0928A0"
          SNOWBRIDGE: x"02C45091B7670B89CC1651524AA9F4D46141D085FE16AD75193AD44086178BC6D5"
          DappRadar: x"0344127844D76346AE6CD4CE01F52DE9E8EDE972E4A1FF26DC7AA70BF6B006858C"
          Nocturnal Labs: x"036293EC53DC8367E850833E64D8AABB6994EE48DDAEC6F6706B9A1FFCF26E0B9F"
          Node.Monster: x"038140EBFD9EC1BDF512C92F5257CFD5ADD3115BE1A7283D2EFC17BBCB8E1C1CDD"
          w3coins: x"02C33257B7F0FACD6D1ACBE2756D355CA86EDBB7451928DC1EA7D1A755D2CEBD48"
          StableLab: x"03BEA42D36FEAFDFD7C3C729152E992F31F1BC5C139E97E0806A7778A50EFDB96A"
          EXNT: x"02D8372E2F11D45803B28C46BDE3A8228346C6D5A27E2A3C3EF12F12CBBA9CC231"
    test:
      modules:
        - economy_chain.test
        - economy_chain.ec_proposal.test
      moduleArgs:
        lib.ft4.accounts:
          rate_limit:
            active: 0
        lib.auth:
          auth_pubkey: x"03284C73391D6FFA90FA95D95BC4F29015C0111A655A9EE6DD7DEC089F32F04B5F" # Only for tests
        economy_chain:
          admin_pubkey: x"02BECC5AA3AC14320BD9DAB1F558F637CFFE39508DEE9F7C2161EDF13A14BACE44" # Only for tests
        economy_chain.test.economy_chain_account_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_container_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_reward_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_test_chr_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_constants_test:
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_directory_chain_sync_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_queries_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_bridge_lease_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
        economy_chain.test.economy_chain_staking_test:
          auth_privkey: x"B563C2BCC29FD0E014FBFC4AF3A69CB6C513C1943DB9A91093886DE18DCBE6C6"  # Only for tests
          admin_privkey: x"D223C1BEF057A86FCB4603BF8CCBF7FFBFAF1F1928ADBD52A8FCCD08E3C487C3"  # Only for tests
          staking_rate_change_delay_ms: 604800000
          staking_withdrawal_delay_ms: 1209600000

database: # Used for running tests
  logSqlErrors: true
  schema: chain0test
  driver: org.postgresql.Driver

test:
  modules:
    - anchoring_chain_common.test
    - anchoring_chain_system.test
    - common.test
    - common.queries.test
    - direct_cluster.test
    - direct_container.test
    - economy_chain_in_directory_chain.test
    - evm_transaction_submitter.test
    - price_oracle.test
    - nm_api.test
    - proposal.test
    - proposal.voting.test
    - proposal_blockchain.test
    - proposal_blockchain_import.test
    - proposal_blockchain_move.test
    - proposal_cluster.test
    - proposal_cluster_anchoring.test
    - proposal_container.test
    - proposal_provider.test
    - proposal_voter_set.test
    - region.test
    - roles.test
  moduleArgs:
    common.init: *common_init
    common:
      allow_blockchain_dependencies: true
      provider_quota_max_actions_per_day: 100
    proposal_blockchain.util:
      max_config_path_depth: 10
      max_config_size: 10240 # 10 KiB, low so we can test limits easier

libs:
  ft4:
    registry: https://bitbucket.org/chromawallet/ft3-lib
    path: rell/src/lib/ft4
    tagOrBranch: v0.5.0r
    rid: x"125809B57980D6E36C07210D0541E7BCAD86A66F324FC1C0DA9CA7D1F8D5A720"
    insecure: false
  auth:
    registry: https://bitbucket.org/chromawallet/auth-server-ft4.git
    path: rell/src/auth
    tagOrBranch: v2.0.0r
    rid: x"85C0F206DE187AB84197AE2ADD721AE5DE7B4A495ADF7FA84244329A320CC92A"
    insecure: false
  priceoracle:
    registry: https://bitbucket.org/chromawallet/priceoracle.git
    path: src
    tagOrBranch: "0.2"
    rid: x"E0D3FAD15812941D2FD52A43BB3E4F2AA8BC8D795A5C27EBA4F9791CC43BE250"
    insecure: false
  common:
    registry: https://gitlab.com/chromaway/postchain-eif
    path: postchain-eif-rell/rell/src/eif/common
    tagOrBranch: 0.3.3
    insecure: true
  evm:
    registry: https://gitlab.com/chromaway/postchain-eif
    path: postchain-eif-rell/rell/src/eif/evm
    tagOrBranch: 0.3.3
    insecure: true
  utils:
    registry: https://gitlab.com/chromaway/postchain-eif
    path: postchain-eif-rell/rell/src/eif/utils
    tagOrBranch: 0.3.3
    insecure: true
  main:
    registry: https://gitlab.com/chromaway/postchain-eif
    path: postchain-eif-rell/rell/src/eif/main
    tagOrBranch: 0.3.3
    insecure: true
  eif_ft4:
    registry: https://gitlab.com/chromaway/postchain-eif
    path: postchain-eif-rell/rell/src/eif/ft4
    tagOrBranch: 0.3.3
    insecure: true
