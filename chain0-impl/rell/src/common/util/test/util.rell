@test module;

import ^^.*;

function test_require_pubkey() {
    // success
    // compressed 33-byte value
    require_pubkey(rell.test.pubkeys.alice);
    // uncompressed 65-byte value
    require_pubkey(x"aaaaaaaaaaaaaaaaa0995d3ed5aaba0565d71e1834604819ff9c17f5e9d5dd078f70beaf8f588b541507fed6a642c5ab42dfdf8120a7f639de5122d47a69a8e8d1");

    // failure
    assert_fails(require_pubkey(x"", *));
    assert_fails(require_pubkey(x"ff", *));
    assert_fails(require_pubkey(x"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff", *));
}