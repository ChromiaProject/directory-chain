module;


import ^.voting.*;

function require_is_provider_with_rl(pubkey) {
    val provider = require_provider(pubkey);
    require_provider_auth_with_rl(provider);
    return provider;
}

// This is the function we should use for auth
function require_provider_auth_with_rl(provider) {
    require_is_signer(provider.pubkey);
    provider_rate_limit(provider);
}

function require_pubkey(pubkey) {
    require(pubkey.size() == 33 or pubkey.size() == 65, "Value is not pubkey: " + pubkey);
}
