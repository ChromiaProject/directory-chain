module;

import ^^.*;

operation initialize_test_module(pubkey, test_node: node_info, majority_threshold:integer = 0, anchoring_config: map<text, gtv> = map<text, gtv>()) {
	initialize_module(pubkey, test_node, 1000, anchoring_config=anchoring_config.to_gtv().to_bytes(), majority_threshold=majority_threshold);
}

operation create_test_provider(name, pubkey, provider_tier = provider_tier.NODE_PROVIDER) {
	if (empty(provider_quota @* { .tier == provider_tier })) {
	    create provider_quota(provider_tier, provider_quota_type.max_actions_per_day, value = 100);
	    create provider_quota(provider_tier, provider_quota_type.max_nodes, value = provider_quota_defaults.MAX_NODES);
	}
	val p = create provider(pubkey, name, active = true, provider_tier);
	create provider_rl_state(p, points = 10000, last_update = 0);
}

operation create_test_node(provider, pubkey, cluster) {
	val c = list<text>();
	c.add(cluster.name);
	add_node_internal(provider, pubkey, "", 0, "", c);
}

operation create_test_voter_set(name, threshold: integer, governor: voter_set?) {
	create_voter_set_internal(name, threshold, governor);
}
