function harmoic_mean(pairs:list<(amount:integer, weight:decimal)>): decimal {
    var sum = 0.0;
    var weight_check = 0.0;
    var result = 0.0;

    for (x in pairs) {
        weight_check += x.weight;
        sum += ( x.weight / x.amount );    
    }

    require(1.0 == weight_check, "Weights must sum to 1.");

    return 1.0 / sum;
}